!function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function i(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(t,e){t.appendChild(e)}function l(t,e,n){t.insertBefore(e,n||null)}function c(t){t.parentNode.removeChild(t)}function a(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function g(){return f(" ")}function d(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function p(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function h(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function m(t,e){e=""+e,t.data!==e&&(t.data=e)}function y(t,e,n){t.classList[n?"add":"remove"](e)}let $;function _(t){$=t}function v(){if(!$)throw new Error("Function called outside component initialization");return $}function x(){const t=v();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const i=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);r.slice().forEach(e=>{e.call(t,i)})}}}const b=[],w=[],k=[],E=[],C=Promise.resolve();let A=!1;function I(t){k.push(t)}function S(t){E.push(t)}function j(){const t=new Set;do{for(;b.length;){const t=b.shift();_(t),N(t.$$)}for(;w.length;)w.pop()();for(let e=0;e<k.length;e+=1){const n=k[e];t.has(n)||(n(),t.add(n))}k.length=0}while(b.length);for(;E.length;)E.pop()();A=!1}function N(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(I)}}const L=new Set;function O(t,e){t&&t.i&&(L.delete(t),t.i(e))}function q(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function M(t,n,o){const{fragment:s,on_mount:l,on_destroy:c,after_update:a}=t.$$;s&&s.m(n,o),I(()=>{const n=l.map(e).filter(i);c?c.push(...n):r(n),t.$$.on_mount=[]}),a.forEach(I)}function W(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function B(t,e){-1===t.$$.dirty[0]&&(b.push(t),A||(A=!0,C.then(j)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function D(e,i,o,s,l,c,a=[-1]){const u=$;_(e);const f=i.props||{},g=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:l,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:n(),dirty:a};let d=!1;g.ctx=o?o(e,f,(t,n,...r)=>{const i=r.length?r[0]:n;return g.ctx&&l(g.ctx[t],g.ctx[t]=i)&&(g.bound[t]&&g.bound[t](i),d&&B(e,t)),n}):[],g.update(),d=!0,r(g.before_update),g.fragment=!!s&&s(g.ctx),i.target&&(i.hydrate?g.fragment&&g.fragment.l(function(t){return Array.from(t.childNodes)}(i.target)):g.fragment&&g.fragment.c(),i.intro&&O(e.$$.fragment),M(e,i.target,i.anchor),j()),_(u)}class H{$destroy(){W(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function P(e){let n,i,o,a,y,$,_,v,x,b,w,k,E,C,A,I;return{c(){n=u("div"),i=u("label"),i.textContent="1",o=g(),a=u("i"),y=g(),$=u("i"),_=g(),v=u("input"),x=g(),b=u("i"),w=g(),k=u("i"),E=g(),C=u("label"),A=f(e[0]),h(a,"class","icon fast-backward"),h(a,"tabindex","-4"),h($,"class","icon backward"),h($,"tabindex","-3"),h(v,"class","current"),h(v,"tabindex","-2"),h(v,"aria-label","current"),h(v,"type","text"),v.value=e[1],h(b,"class","icon forward"),h(b,"tabindex","-1"),h(k,"class","icon fast-forward"),h(k,"tabindex","0"),h(n,"class","pager")},m(t,r){l(t,n,r),s(n,i),s(n,o),s(n,a),s(n,y),s(n,$),s(n,_),s(n,v),s(n,x),s(n,b),s(n,w),s(n,k),s(n,E),s(n,C),s(C,A),I=[d(a,"click",p(e[2])),d($,"click",p(e[3])),d(v,"change",p(e[6])),d(b,"click",p(e[4])),d(k,"click",p(e[5]))]},p(t,[e]){2&e&&v.value!==t[1]&&(v.value=t[1]),1&e&&m(A,t[0])},i:t,o:t,d(t){t&&c(n),r(I)}}}function R(t,e,n){const r=x();let{max:i=0}=e,{current:o=0}=e;let s=0,l=0;return t.$set=t=>{"max"in t&&n(0,i=t.max),"current"in t&&n(1,o=t.current)},t.$$.update=()=>{387&t.$$.dirty&&(Number.isInteger(i)&&1<=i?n(8,l=i):n(0,i=l),Number.isInteger(o)&&1<=o&&o<=i?(n(7,s=o),r("change",s)):n(1,o=s))},[i,o,function(){n(1,o=1)},function(){n(1,--o)},function(){n(1,++o)},function(){n(1,o=i)},function({target:t}){n(1,o=parseInt(t.value,10))}]}class z extends H{constructor(t){super(),D(this,t,R,P,o,{max:0,current:1,start:2,backward:3,forward:4,end:5})}get start(){return this.$$.ctx[2]}get backward(){return this.$$.ctx[3]}get forward(){return this.$$.ctx[4]}get end(){return this.$$.ctx[5]}}function F(t,e,n){const r=t.slice();return r[28]=e[n],r[30]=n,r}function T(t,e,n){const r=t.slice();return r[25]=e[n],r[27]=n,r}function G(t,e,n){const r=t.slice();return r[31]=e[n],r}function J(t,e,n){const r=t.slice();return r[34]=e[n].title,r[27]=n,r}function K(t,e,n){const r=t.slice();return r[31]=e[n],r}function Q(t){let e;return{c(){e=u("col")},m(t,n){l(t,e,n)},d(t){t&&c(e)}}}function U(t){let e,n,r=t[34]+"";return{c(){e=u("td"),n=f(r)},m(t,r){l(t,e,r),s(e,n)},p(t,e){16&e[0]&&r!==(r=t[34]+"")&&m(n,r)},d(t){t&&c(e)}}}function V(t){let e,n,r,i,o,f=t[4],d=[];for(let e=0;e<f.length;e+=1)d[e]=X(G(t,f,e));let p=t[2],m=[];for(let e=0;e<p.length;e+=1)m[e]=et(T(t,p,e));return{c(){e=u("div"),n=u("table"),r=u("colgroup");for(let t=0;t<d.length;t+=1)d[t].c();i=g(),o=u("tbody");for(let t=0;t<m.length;t+=1)m[t].c();h(n,"cellspacing","0"),h(n,"cellpadding","0"),h(e,"class","content")},m(c,a){l(c,e,a),s(e,n),s(n,r);for(let t=0;t<d.length;t+=1)d[t].m(r,null);t[20](r),s(n,i),s(n,o);for(let t=0;t<m.length;t+=1)m[t].m(o,null);t[21](o)},p(t,e){if(16&e[0]){const e=f.length;let n;for(f=t[4],n=e;n<f.length;n+=1){G(t,f,n);d[n]||(d[n]=X(),d[n].c(),d[n].m(r,null))}for(n=f.length;n<e;n+=1)d[n].d(1);d.length=f.length}if(1076&e[0]){let n;for(p=t[2],n=0;n<p.length;n+=1){const r=T(t,p,n);m[n]?m[n].p(r,e):(m[n]=et(r),m[n].c(),m[n].m(o,null))}for(;n<m.length;n+=1)m[n].d(1);m.length=p.length}},d(n){n&&c(e),a(d,n),t[20](null),a(m,n),t[21](null)}}}function X(t){let e;return{c(){e=u("col")},m(t,n){l(t,e,n)},d(t){t&&c(e)}}}function Y(t){let e,n,r=t[10](t[25][t[28]],t[30])+"";return{c(){e=u("td"),n=f(r)},m(t,r){l(t,e,r),s(e,n)},p(t,e){36&e[0]&&r!==(r=t[10](t[25][t[28]],t[30])+"")&&m(n,r)},d(t){t&&c(e)}}}function Z(t){let e,n,r,i=t[10](t[25][t[28]],t[30])+"";return{c(){e=u("td"),n=f(i),h(e,"style",r=t[4][t[30]].style)},m(t,r){l(t,e,r),s(e,n)},p(t,o){36&o[0]&&i!==(i=t[10](t[25][t[28]],t[30])+"")&&m(n,i),16&o[0]&&r!==(r=t[4][t[30]].style)&&h(e,"style",r)},d(t){t&&c(e)}}}function tt(t){let e;function n(t,e){return"string"==typeof t[4][t[30]].style?Z:Y}let r=n(t),i=r(t);return{c(){i.c(),e=f("")},m(t,n){i.m(t,n),l(t,e,n)},p(t,o){r===(r=n(t))&&i?i.p(t,o):(i.d(1),i=r(t),i&&(i.c(),i.m(e.parentNode,e)))},d(t){i.d(t),t&&c(e)}}}function et(t){let e,n,r=t[5],i=[];for(let e=0;e<r.length;e+=1)i[e]=tt(F(t,r,e));return{c(){e=u("tr");for(let t=0;t<i.length;t+=1)i[t].c();n=g(),y(e,"odd",t[27]%2==0),y(e,"even",t[27]%2!=0)},m(t,r){l(t,e,r);for(let t=0;t<i.length;t+=1)i[t].m(e,null);s(e,n)},p(t,o){if(1076&o[0]){let s;for(r=t[5],s=0;s<r.length;s+=1){const l=F(t,r,s);i[s]?i[s].p(l,o):(i[s]=tt(l),i[s].c(),i[s].m(e,n))}for(;s<i.length;s+=1)i[s].d(1);i.length=r.length}},d(t){t&&c(e),a(i,t)}}}function nt(t){let e,n,r,i,o,f,d,p,m,$,_,v,x,b,k,E=Array.isArray(t[2])&&t[2].length>0,C=t[4],A=[];for(let e=0;e<C.length;e+=1)A[e]=Q(K(t,C,e));let I=t[4],j=[];for(let e=0;e<I.length;e+=1)j[e]=U(J(t,I,e));let N=E&&V(t);function B(e){t[22].call(null,e)}function D(e){t[23].call(null,e)}let H={};void 0!==t[0]&&(H.current=t[0]),void 0!==t[1]&&(H.max=t[1]);const P=new z({props:H});return w.push(()=>q(P,"current",B)),w.push(()=>q(P,"max",D)),P.$on("change",t[24]),{c(){e=u("div"),n=u("div"),r=u("table"),i=u("colgroup");for(let t=0;t<A.length;t+=1)A[t].c();o=g(),f=u("tbody"),d=u("tr");for(let t=0;t<j.length;t+=1)j[t].c();var s;p=g(),N&&N.c(),m=g(),$=u("div"),_=u("i"),v=g(),(s=P.$$.fragment)&&s.c(),h(r,"cellspacing","0"),h(r,"cellpadding","0"),h(n,"class","header"),h(_,"class","status"),y(_,"check-circle","success"===t[3]),y(_,"loading","waiting"===t[3]),y(_,"exclamation-circle","error"===t[3]),y(_,"none","none"===t[3]),h($,"class","footer"),h(e,"class","grid")},m(c,a){l(c,e,a),s(e,n),s(n,r),s(r,i);for(let t=0;t<A.length;t+=1)A[t].m(i,null);t[18](i),s(r,o),s(r,f),s(f,d);for(let t=0;t<j.length;t+=1)j[t].m(d,null);t[19](f),s(e,p),N&&N.m(e,null),s(e,m),s(e,$),s($,_),s($,v),M(P,$,null),k=!0},p(t,n){if(16&n[0]){const e=C.length;let n;for(C=t[4],n=e;n<C.length;n+=1){K(t,C,n);A[n]||(A[n]=Q(),A[n].c(),A[n].m(i,null))}for(n=C.length;n<e;n+=1)A[n].d(1);A.length=C.length}if(16&n[0]){let e;for(I=t[4],e=0;e<I.length;e+=1){const r=J(t,I,e);j[e]?j[e].p(r,n):(j[e]=U(r),j[e].c(),j[e].m(d,null))}for(;e<j.length;e+=1)j[e].d(1);j.length=I.length}4&n[0]&&(E=Array.isArray(t[2])&&t[2].length>0),E?N?N.p(t,n):(N=V(t),N.c(),N.m(e,m)):N&&(N.d(1),N=null),8&n[0]&&y(_,"check-circle","success"===t[3]),8&n[0]&&y(_,"loading","waiting"===t[3]),8&n[0]&&y(_,"exclamation-circle","error"===t[3]),8&n[0]&&y(_,"none","none"===t[3]);const r={};!x&&1&n[0]&&(x=!0,r.current=t[0],S(()=>x=!1)),!b&&2&n[0]&&(b=!0,r.max=t[1],S(()=>b=!1)),P.$set(r)},i(t){k||(O(P.$$.fragment,t),k=!0)},o(t){!function(t,e,n,r){if(t&&t.o){if(L.has(t))return;L.add(t),(void 0).c.push(()=>{L.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}(P.$$.fragment,t),k=!1},d(n){n&&c(e),a(A,n),t[18](null),a(j,n),t[19](null),N&&N.d(),W(P)}}}function rt(t,e,n){let r,i,o,s,{page:l}=e,{pages:c=1}=e,{rows:a=[]}=e,{status:u="waiting"}=e,{columns:f={}}=e,{visibleColumns:g=[]}=e,{formatters:d={date:t=>{const e=/(?<d>\d\d)\/(?<m>\d\d)\/(?<y>\d\d\d\d)\s(?<H>\d\d?):(?<M>\d\d?)/g.exec(t);if(e&&e.groups){const t=parseInt(e.groups.y,10),n=parseInt(e.groups.m,10)-1,r=parseInt(e.groups.d,10),i=parseInt(e.groups.H,10),o=parseInt(e.groups.M,10);return new Date(t,n,r,i,o).toLocaleDateString()}return t}}}=e,p=[],h=[];var m;return m=()=>{if(r&&i&&o&&s){const t=i.querySelector("tr"),e=s.querySelector("tr");for(let i=0;i<e.children.length;++i){const s=e.children[i].getBoundingClientRect(),l=t.children[i].getBoundingClientRect(),c=s.width>l.width?s.width:l.width;n(6,r.children[i].style.width=`${c}px`,r),n(8,o.children[i].style.width=`${c}px`,o)}}},v().$$.after_update.push(m),t.$set=t=>{"page"in t&&n(0,l=t.page),"pages"in t&&n(1,c=t.pages),"rows"in t&&n(2,a=t.rows),"status"in t&&n(3,u=t.status),"columns"in t&&n(11,f=t.columns),"visibleColumns"in t&&n(12,g=t.visibleColumns),"formatters"in t&&n(13,d=t.formatters)},t.$$.update=()=>{if(6192&t.$$.dirty[0]){n(4,p=[]),n(5,h=[]);const t=Object.keys(f);for(let e=0;e<t.length;++e){let n=t[e];-1!=g.indexOf(n)&&(h.push(e),p.push(f[n]))}}},[l,c,a,u,p,h,r,i,o,s,function(t,e){const{type:n,formatter:r}=p[e],i=d[n];return"function"==typeof r?r(t):"function"==typeof i?i(t):t},f,g,d,function(){n(0,l=1)},function(){n(0,--l)},function(){n(0,++l)},function(){n(0,l=c)},function(t){w[t?"unshift":"push"](()=>{n(6,r=t)})},function(t){w[t?"unshift":"push"](()=>{n(7,i=t)})},function(t){w[t?"unshift":"push"](()=>{n(8,o=t)})},function(t){w[t?"unshift":"push"](()=>{n(9,s=t)})},function(t){l=t,n(0,l)},function(t){c=t,n(1,c)},function(e){!function(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(t=>t(e))}(t,e)}]}class it extends H{constructor(t){super(),D(this,t,rt,nt,o,{page:0,pages:1,rows:2,status:3,columns:11,visibleColumns:12,formatters:13,start:14,backward:15,forward:16,end:17},[-1,-1])}get start(){return this.$$.ctx[14]}get backward(){return this.$$.ctx[15]}get forward(){return this.$$.ctx[16]}get end(){return this.$$.ctx[17]}}var ot={id:{type:"integer",title:"id"},mmsi:{type:"integer",title:"mmsi"},imo:{type:"integer",title:"imo"},vessel_name:{type:"string",title:"Название"},callsign:{type:"string",title:"Радиопозывной"},vessel_type:{type:"string",title:"Тип"},vessel_type_code:{type:"integer",title:"vessel_type_code"},vessel_type_cargo:{type:"string",title:"vessel_type_cargo"},vessel_class:{type:"string",title:"vessel_class"},length:{type:"integer",title:"length"},width:{type:"integer",title:"width"},flag_country:{type:"string",title:"Флаг"},flag_code:{type:"integer",title:"flag_code"},destination:{type:"string",title:"Пункт назначения"},eta:{type:"string",title:"Время прибытия"},draught:{type:"float",title:"draught"},longitude:{type:"float",title:"Долгота"},latitude:{type:"float",title:"Широта"},sog:{type:"float",title:"Скорость",style:"text-align: right"},cog:{type:"float",title:"Курс",style:"text-align: right"},rot:{type:"float",title:"Угловая скорость поворота",style:"text-align: right"},heading:{type:"integer",title:"Путевой угол",style:"text-align: right"},nav_status:{type:"string",title:"nav_status"},nav_status_code:{type:"integer",title:"nav_status_code"},source:{type:"string",title:"source"},ts_pos_utc:{type:"date",title:"ts_pos_utc"},ts_static_utc:{type:"date",title:"ts_static_utc"},ts_eta:{type:"date",title:"ts_eta"},ts_insert_utc:{type:"date",title:"ts_insert_utc"},registry_name:{type:"string",title:"registry_name"},registry_name_en:{type:"string",title:"registry_name_en"},vessel_type_main:{type:"string",title:"vessel_type_main"},vessel_type_sub:{type:"string",title:"vessel_type_sub"},message_type:{type:"integer",title:"message_type"}};window.addEventListener("load",()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(t=>{console.log("ServiceWorker registration successful with scope: ",t.scope)},t=>{console.log("ServiceWorker registration failed: ",t)});const t=document.querySelector("#app"),e=new it({target:t,props:{visibleColumns:["vessel_name","vessel_type","callsign","flag_country","destination","eta","heading","sog","cog"],columns:ot}});e.$on("change",({detail:t})=>{const n=50*(t-1);e.$set({status:"waiting"}),fetch(`/ais/50/${n}`).then(t=>t.json()).then(({count:t,rows:n})=>{const r=n.map(t=>Object.keys(t).map(e=>t[e]));e.$set({rows:r,pages:Math.ceil(t/50),status:"success"})}).catch(t=>{e.$set({status:"error"})})}),e.start()})}();
//# sourceMappingURL=main.js.map
